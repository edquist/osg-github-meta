{
  "author_association": "MEMBER", 
  "body": "\\*shiver\\*  ... I guess that works.\r\n\r\nBut yeah i meant something independent of the spec file.  I guess with `osg-build prep` the spec has to be correct enough to run the prep step, and finding the right file under `_final_srpm_contents` requires parsing the `osg-build prep` output; which also sometimes includes a fair amount of \"work\".\r\n\r\nThis is the `cp-upstream` script i use currently:\r\n\r\n```\r\n#!/bin/bash\r\n\r\nusage () {\r\n  echo \"$(basename \"$0\") bla.bla.source [cp options] dest\"\r\n  exit\r\n}\r\n\r\n[[ -f $1 ]] || usage\r\n[[ $2 ]] || usage\r\n\r\nsource=$1\r\nshift\r\n\r\nfor upsrc in $(grep '^[^#]' \"$source\"); do\r\n  cp \"/p/vdt/public/html/upstream/$upsrc\" \"$@\"\r\ndone\r\n```\r\n\r\nEg, for our `voms` package:\r\n\r\n```\r\n[edquist@monza ~/scratch/git/redhat/pkgs/voms]$ time cp-upstream upstream/epel.srpm.source .\r\n\r\nreal\t0m0.009s\r\nuser\t0m0.000s\r\nsys\t0m0.002s\r\n[edquist@monza ~/scratch/git/redhat/pkgs/voms]$ ls -lrt\r\ntotal 480\r\n-rw-r--r-- 1 edquist edquist     96 Oct 16  2015 README\r\ndrwxr-xr-x 2 edquist edquist   4096 Oct 16  2015 upstream\r\ndrwxr-xr-x 2 edquist edquist   4096 Apr 27  2016 osg\r\n-rw-r--r-- 1 edquist edquist 475925 Apr 18 15:26 voms-2.0.12-3.el6.src.rpm\r\n```\r\n\r\nVersus\r\n\r\n```\r\n[edquist@monza ~/scratch/git/redhat/pkgs/voms]$ time osg-build prep .\r\n >> Retrieving file:///p/vdt/public/html/upstream/voms/2.0.12/voms-2.0.12-3.el6.src.rpm\r\n >> Unpacking SRPM /scratch/edquist/git/redhat/pkgs/voms/_final_srpm_contents/voms-2.0.12-3.el6.src.rpm\r\n939 blocks\r\n >> Files have been prepared in /scratch/edquist/git/redhat/pkgs/voms/_final_srpm_contents.\r\nExecuting(%prep): /bin/sh -e /scratch/edquist/git/redhat/pkgs/voms/_build_results/tmp/rpm-tmp.X4JCZY\r\n+ umask 022\r\n+ cd /scratch/edquist/git/redhat/pkgs/voms/_build_results/BUILD\r\n+ LANG=C\r\n+ export LANG\r\n+ unset DISPLAY\r\n+ cd /scratch/edquist/git/redhat/pkgs/voms/_build_results/BUILD\r\n+ rm -rf voms-2.0.12\r\n+ /usr/bin/gzip -dc /scratch/edquist/git/redhat/pkgs/voms/_build_results/v2.0.12.tar.gz\r\n+ /bin/tar -xf -\r\n+ STATUS=0\r\n+ '[' 0 -ne 0 ']'\r\n+ cd voms-2.0.12\r\n+ /bin/chmod -Rf a+rX,u+w,g-w,o-w .\r\n+ ./autogen.sh\r\n/usr/share/aclocal/aalib.m4:12: warning: underquoted definition of AM_PATH_AALIB\r\n/usr/share/aclocal/aalib.m4:12:   run info '(automake)Extending aclocal'\r\n/usr/share/aclocal/aalib.m4:12:   or see http://sources.redhat.com/automake/automake.html#Extending-aclocal\r\nlibtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, `./aux'.\r\nlibtoolize: copying file `./aux/ltmain.sh'\r\nlibtoolize: putting macros in AC_CONFIG_MACRO_DIR, `m4'.\r\nlibtoolize: copying file `m4/libtool.m4'\r\nlibtoolize: copying file `m4/ltoptions.m4'\r\nlibtoolize: copying file `m4/ltsugar.m4'\r\nlibtoolize: copying file `m4/ltversion.m4'\r\nlibtoolize: copying file `m4/lt~obsolete.m4'\r\n/usr/share/aclocal/aalib.m4:12: warning: underquoted definition of AM_PATH_AALIB\r\n/usr/share/aclocal/aalib.m4:12:   run info '(automake)Extending aclocal'\r\n/usr/share/aclocal/aalib.m4:12:   or see http://sources.redhat.com/automake/automake.html#Extending-aclocal\r\nconfigure.ac:24: installing `./aux/compile'\r\nconfigure.ac:29: installing `./aux/config.guess'\r\nconfigure.ac:29: installing `./aux/config.sub'\r\nconfigure.ac:4: installing `./aux/install-sh'\r\nconfigure.ac:4: installing `./aux/missing'\r\ndoc/Makefile.am:83: `%'-style pattern rules are a GNU make extension\r\ndoc/Makefile.am:86: `%'-style pattern rules are a GNU make extension\r\ndoc/Makefile.am:89: `%'-style pattern rules are a GNU make extension\r\ndoc/Makefile.am:93: `%'-style pattern rules are a GNU make extension\r\ndoc/Makefile.am:96: `%'-style pattern rules are a GNU make extension\r\nsrc/ac/Makefile.am: installing `./aux/depcomp'\r\nMakefile.am:94: shell find $(rpmbuild_dir: non-POSIX variable name\r\nMakefile.am:94: (probably a GNU make extension)\r\n+ install -m 644 /scratch/edquist/git/redhat/pkgs/voms/_build_results/voms.INSTALL README.Fedora\r\n+ exit 0\r\n >> Files prepared in: /scratch/edquist/git/redhat/pkgs/voms/_build_results/BUILD\r\n\r\nreal\t0m13.877s\r\nuser\t0m9.089s\r\nsys\t0m0.407s\r\n[edquist@monza ~/scratch/git/redhat/pkgs/voms]$ ls -lrt _final_srpm_contents/\r\ntotal 1420\r\n-rw-r--r-- 1 edquist edquist 475925 Apr 18 15:27 voms-2.0.12-3.el6.src.rpm\r\n-rw-r--r-- 1 edquist edquist   1726 Apr 18 15:27 voms.INSTALL\r\n-rw-rw-r-- 1 edquist edquist 454920 Apr 18 15:27 v2.0.12.tar.gz\r\n-rw-r--r-- 1 edquist edquist  23458 Apr 18 15:27 voms.spec\r\n-rw-r--r-- 1 edquist edquist   5104 Apr 18 15:27 mariadb-innodb.patch\r\n-rw-r--r-- 1 edquist edquist 477159 Apr 18 15:27 voms-2.0.12-3.1.osg.el6.src.rpm\r\n```", 
  "created_at": "2017-04-18T20:30:19Z", 
  "html_url": "https://github.com/opensciencegrid/osg-build/pull/30#issuecomment-294971786", 
  "id": 294971786, 
  "issue_url": "https://api.github.com/repos/opensciencegrid/osg-build/issues/30", 
  "updated_at": "2017-04-18T20:30:19Z", 
  "url": "https://api.github.com/repos/opensciencegrid/osg-build/issues/comments/294971786", 
  "user": {
    "avatar_url": "https://avatars3.githubusercontent.com/u/5522437?v=4", 
    "events_url": "https://api.github.com/users/edquist/events{/privacy}", 
    "followers_url": "https://api.github.com/users/edquist/followers", 
    "following_url": "https://api.github.com/users/edquist/following{/other_user}", 
    "gists_url": "https://api.github.com/users/edquist/gists{/gist_id}", 
    "gravatar_id": "", 
    "html_url": "https://github.com/edquist", 
    "id": 5522437, 
    "login": "edquist", 
    "organizations_url": "https://api.github.com/users/edquist/orgs", 
    "received_events_url": "https://api.github.com/users/edquist/received_events", 
    "repos_url": "https://api.github.com/users/edquist/repos", 
    "site_admin": false, 
    "starred_url": "https://api.github.com/users/edquist/starred{/owner}{/repo}", 
    "subscriptions_url": "https://api.github.com/users/edquist/subscriptions", 
    "type": "User", 
    "url": "https://api.github.com/users/edquist"
  }
}
